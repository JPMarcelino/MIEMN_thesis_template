% ---------------------------------------------------------------------
% MIEMN Thesis Template
% This document is pre-configured to comply with the FCT NOVA rules:
%   - Times New Roman, 11 pt font
%   - 1.25 line spacing
%   - 2 cm margins on all sides
%   - No blank pages between sections
% Fill in the placeholders and remove example text as you draft your thesis.
% ---------------------------------------------------------------------
\documentclass[11pt, a4paper]{report}

% =====================================================================
% PACKAGES
% =====================================================================
\usepackage[a4paper, margin=2cm]{geometry} % A4 layout with 2 cm margins on all sides
\usepackage{times} % Use Times New Roman font for all text
\usepackage{setspace} % Allows custom line spacing
\usepackage{fancyhdr} % Control over headers and footers
\usepackage{titlesec} % Custom chapter and section headings
\usepackage{graphicx} % Insert figures and images
\usepackage{caption} % Tweak figure and table captions
\usepackage{float} % Enforce precise placement of figures/tables
\usepackage{tocbibind} % Add bibliography to the table of contents
\usepackage{amsmath, amssymb} % Math environments and symbols
\usepackage{lipsum} % Placeholder text; remove in final document
\usepackage{appendix} % Support for appendices
\usepackage{xcolor} % Enable colored text and highlighted code
\usepackage{wallpaper} % Optionally place background images
\usepackage[numbers]{natbib} % Numeric citation style
\usepackage{microtype} % Subtle typographic improvements
\usepackage{ragged2e} % Enhanced text alignment commands
\usepackage{bookmark} % Improve PDF bookmarks
\usepackage{siunitx} % Consistent typesetting of units
\usepackage{booktabs} % Professional quality tables
\usepackage{textcomp} % Additional text symbols
\usepackage{gensymb} % Generic scientific symbols (e.g., degree)
\usepackage{subcaption}   % Modern subfigure support
\usepackage{tabularx,threeparttable,makecell} % Flexible tables with wrapped text
\usepackage{enumitem} % Customizable itemize/enumerate lists
\usepackage{hyperref} % Hyperlinks within the PDF
\usepackage{verbatim} % Verbatim text (useful for code listings)
\usepackage{listings} % Nicely formatted code blocks
\usepackage{tikz} % Create vector graphics and diagrams
\usepackage[xindy]{glossaries} % Manage glossaries and lists of abbreviations


% Define two glossaries: one for acronyms, one for notation
\newglossary[alg]{acronym}{acr}{acn}{List of Abbreviations}
\newglossary[nlg]{notation}{not}{ntn}{List of Notation}
\makeglossaries

% Custom glossary styles to produce your tabular layouts
\newglossarystyle{tabularabbr}{%
  \setglossarystyle{long}% base style
  \renewenvironment{theglossary}%
    {\begin{tabular}{p{0.18\linewidth} p{0.75\linewidth}}%
     \textbf{Abbreviation} & \textbf{Definition} \\ \hline}%
    {\end{tabular}}%
  \renewcommand*{\glossentry}[2]{%
    \glsentryshort{##1} & \glsentrylong{##1} \\  
  }%
}

\newglossarystyle{tabularnotation}{%
  \setglossarystyle{long}%
  \renewenvironment{theglossary}%
    {\begin{tabular}{p{0.25\linewidth} p{0.75\linewidth}}%
     \textbf{Symbol} & \textbf{Meaning} \\ \hline}%
    {\end{tabular}}%
  \renewcommand*{\glossentry}[2]{%
    \glsentryname{##1} & \glossentrydesc{##1} \\%
  }%
}


% =====================================================================
% FORMATTING & SETUP
% =====================================================================
\setstretch{1.25} % 1.25 line spacing as required by FCT NOVA rules

\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}
\captionsetup[figure]{font=small}
\setlength{\emergencystretch}{3em}
\bibliographystyle{unsrtnat} % Replace with an American or IOP style if required
\tolerance=1000
\emergencystretch=\maxdimen%
\hyphenpenalty=10000
\hbadness=10000

% Customizing headings (user preference, kept as is)
\titleformat{\chapter}[hang]
    {\normalfont\huge\bfseries\raggedleft}
    {\thechapter\hspace{1em}$|$\hspace{1em}}
    {0pt}
    {}
\titlespacing*{\chapter}{0pt}{50pt}{40pt}
\titleformat{\section}[hang]
    {\normalfont\Large\bfseries}{\thesection}{1em}{}
\titlespacing*{\section}{0pt}{0pt}{0pt}

% Header and Footer customization to meet regulations
\pagestyle{fancy}
\fancyhf{} % Clear all header and footer fields
\fancyhead[L]{}
\fancyfoot[R]{\thepage} % Page numbers at the bottom right
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}
\setlength{\headheight}{14.5pt}

% Import system for sections
\newcommand{\importsection}[1]{\input{sections/#1}}

% =====================================================================
% CUSTOM COMMANDS FOR FRONT/BACK MATTER
% =====================================================================

% Updated front page to include all required information
\newcommand{\frontpage}{
    \begin{titlepage}
        \centering
        % \includegraphics[width=0.3\textwidth]{figures/university-logo.png}\\ % University logo
        \vspace{2cm}
        {\Huge\bfseries [THESIS TITLE]\par}
        \vspace{1.5cm}
        {\Large [Subtitle if applicable]\par}
        \vfill
        {\Large\bfseries [Author Name]\par}
        \vfill
        A thesis submitted in fulfillment of the requirements\\
        for the degree of \emph{[Degree]}\\
        in [Field of Study]\\
        \vspace{2cm}
        {\bfseries Supervisor(s):}\\[0.5em]
        [Supervisor Name]\\
        [Co-supervisor Name]\\[2cm]
        {\bfseries Examining Committee:}\\[0.5em]
        President: [President Name]\\
        Examiner: [Examiner Name]\\
        Member: [Member Name]\\[2cm]
        [University Name]\\
        \vspace{1cm}
        {\large [Month Year]\par}
    \end{titlepage}
}

% ADDED: Command for the mandatory copyright page
\newcommand{\copyrightpage}{
    \thispagestyle{empty}
    \vspace*{0.1\textheight} % Adjust spacing as needed
    \importsection{copyright} % Create a "copyright.tex" file with the required text
    \clearpage % Avoid blank page after copyright
}

% =====================================================================
% DOCUMENT START
% =====================================================================
\begin{document}

\frontpage%
\thispagestyle{empty}

% ADDED: Copyright page immediately after title page
\copyrightpage

\pagenumbering{roman} % Roman numerals for preliminary pages

% Replaced "Summary" with required Portuguese and English abstracts
\chapter*{Resumo}
\importsection{resumo} % NOTE: Create a "resumo.tex" file for your Portuguese abstract
\clearpage % Start the next section on a new page without blank pages

\chapter*{Abstract}
\importsection{abstract} % NOTE: Create an "abstract.tex" file for your English abstract
\clearpage % Start the next section on a new page without blank pages

\chapter*{Acknowledgements}
\importsection{acknowledgements}


\input{glossary} % assumes glossary.tex is in same directory!


\addtocontents{toc}{\protect\setcounter{tocdepth}{-1}}
\tableofcontents
\clearpage % Separate sections without blank pages

\listoffigures
\clearpage % Separate sections without blank pages

\listoftables
\clearpage % Separate sections without blank pages
\addtocontents{toc}{\protect\setcounter{tocdepth}{5}}


% Start main content with Arabic numerals from page 1
\pagenumbering{arabic}
\setcounter{page}{1}

\chapter{Introduction}
\importsection{introduction}
\clearpage % Start new chapter without blank page

\chapter{State of the Art}
\importsection{stateoftheart}
\clearpage % Start new chapter without blank page

\chapter{Materials and Methods}
\importsection{methods}
\clearpage % Start new chapter without blank page

\chapter{Results and Discussion}
\importsection{results_patched}
\clearpage % Start new chapter without blank page

\chapter{Conclusions and Future Perspectives}
\importsection{conclusions}
\clearpage % Start new chapter without blank page

\bibliography{bibliography}
\clearpage % Start new chapter without blank page

\appendix
\chapter{Annexes}
\importsection{appendix_a}
\clearpage % Start new chapter without blank page
\importsection{appendix_b}
\clearpage % Start new chapter without blank page

\end{document}